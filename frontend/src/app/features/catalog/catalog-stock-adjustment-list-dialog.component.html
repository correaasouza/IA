<mat-dialog-content class="adjustment-list-dialog-content">
  <section class="adjustment-list-header-card">
    <div class="adjustment-list-title-main">
      <div class="adjustment-list-title-label">{{ title() }}</div>
      <div class="adjustment-list-title-meta">Cadastre tipos de ajuste para ENTRADA, SAIDA e TRANSFERENCIA.</div>
    </div>
    <div class="adjustment-list-header-actions">
      <button mat-stroked-button type="button" (click)="close(false)">
        <mat-icon>close</mat-icon>
        Fechar
      </button>
      <button mat-flat-button color="primary" type="button" (click)="openCreate()">
        <mat-icon>add</mat-icon>
        Novo tipo
      </button>
    </div>
  </section>

  <section class="adjustment-list-card">
    <div class="adjustment-list-filters">
      <mat-form-field appearance="outline">
        <mat-label>Buscar</mat-label>
        <input matInput type="text" [(ngModel)]="searchTerm" (ngModelChange)="onFilterChanged()" placeholder="Codigo ou nome" />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Status</mat-label>
        <mat-select [(ngModel)]="statusFilter" (ngModelChange)="onFilterChanged()">
          <mat-option value="ALL">Todos</mat-option>
          <mat-option value="ACTIVE">Ativos</mat-option>
          <mat-option value="INACTIVE">Inativos</mat-option>
        </mat-select>
      </mat-form-field>
      <div class="adjustment-list-count">{{ (filteredRows() || []).length }} registro(s)</div>
    </div>

    <div class="rounded-lg border border-dashed border-[var(--border)] bg-[var(--surface-muted)] p-2.5 text-xs text-[var(--muted)]" *ngIf="loading">
      Carregando tipos de ajuste...
    </div>

    <div class="rounded-lg border border-dashed border-[#fda29b] bg-[#fef3f2] p-2.5 text-xs text-[#b42318]" *ngIf="!loading && error">
      {{ error }}
    </div>

    <div class="adjustment-list-table-wrap" *ngIf="!loading && !error">
      <ng-container *ngIf="filteredRows() as rows">
        <table class="adjustment-list-table" *ngIf="rows.length > 0; else noRows">
          <thead>
            <tr>
              <th>Codigo</th>
              <th>Nome</th>
              <th>Tipo</th>
              <th>Ordem</th>
              <th>Status</th>
              <th class="text-right">Acoes</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of pagedRows(rows)">
              <td>{{ row.codigo }}</td>
              <td>{{ row.nome }}</td>
              <td>{{ typeLabel(row.tipo) }}</td>
              <td>{{ row.ordem }}</td>
              <td>{{ row.active ? 'Ativo' : 'Inativo' }}</td>
              <td class="text-right">
                <div class="adjustment-list-actions">
                  <button mat-icon-button type="button" matTooltip="Editar" (click)="openEdit(row)">
                    <mat-icon>edit</mat-icon>
                  </button>
                  <button mat-icon-button color="warn" type="button" matTooltip="Remover" (click)="remove(row)">
                    <mat-icon>delete</mat-icon>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <ng-template #noRows>
          <div class="adjustment-list-empty">Nenhum tipo de ajuste encontrado.</div>
        </ng-template>

        <mat-paginator
          class="adjustment-list-paginator"
          *ngIf="rows.length > 0"
          [length]="rows.length"
          [pageIndex]="pageIndex"
          [pageSize]="pageSize"
          [pageSizeOptions]="pageSizeOptions"
          (page)="onPageChange($event)">
        </mat-paginator>
      </ng-container>
    </div>
  </section>
</mat-dialog-content>
