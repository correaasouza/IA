<div class="page">
  <header class="page-header">
    <div class="title-block">
      <h1>Configurações de entidades</h1>
      <p>Controle status dos tipos e tipos de contato</p>
    </div>
  </header>

  <section class="panel">
    <div class="panel-header">
      <div class="panel-title">Tipos de entidade</div>
      <div class="panel-meta">Atualize nome e status</div>
    </div>

    <div class="panel-loader" *ngIf="loading">
      <app-inline-loader label="Carregando tipos"></app-inline-loader>
    </div>

    <div class="table-wrap" *ngIf="tipos.length > 0">
      <table mat-table [dataSource]="tipos" class="table-dense">
        <ng-container matColumnDef="codigo">
          <th mat-header-cell *matHeaderCellDef>Código</th>
          <td mat-cell *matCellDef="let row">{{ row.codigo }}</td>
        </ng-container>
        <ng-container matColumnDef="nome">
          <th mat-header-cell *matHeaderCellDef>Nome</th>
          <td mat-cell *matCellDef="let row">
            <input matInput [value]="row.nome" (input)="row.nome = $any($event.target).value" aria-label="Nome" />
          </td>
        </ng-container>
        <ng-container matColumnDef="ativo">
          <th mat-header-cell *matHeaderCellDef>Ativo</th>
          <td mat-cell *matCellDef="let row">
            <mat-slide-toggle [(ngModel)]="row.ativo" aria-label="Ativo"></mat-slide-toggle>
          </td>
        </ng-container>
        <ng-container matColumnDef="save">
          <th mat-header-cell *matHeaderCellDef>Ação</th>
          <td mat-cell *matCellDef="let row" class="actions">
            <button mat-stroked-button (click)="saveDef(row)" [disabled]="savingIds.has(row.id)">
              <mat-icon>save</mat-icon>
              Salvar
            </button>
            <span class="feedback ok" *ngIf="savedIds.has(row.id)">
              <mat-icon>check_circle</mat-icon>
              Salvo
            </span>
            <span class="feedback error" *ngIf="errorIds.has(row.id)">
              <mat-icon>error</mat-icon>
              Erro
            </span>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="defColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: defColumns;"></tr>
      </table>
    </div>

    <section class="empty-state" *ngIf="tipos.length === 0">
      <mat-icon>category</mat-icon>
      <div>
        <div class="empty-title">Nenhum tipo encontrado</div>
        <div class="empty-subtitle">Cadastre tipos de entidade para configurar permissões.</div>
      </div>
    </section>
  </section>

  <section class="panel">
    <div class="panel-header">
      <div class="panel-title">Configurar tipos de contato</div>
      <div class="panel-meta">Gerencie opções e máscaras</div>
    </div>
    <app-contato-tipos></app-contato-tipos>
  </section>
</div>
